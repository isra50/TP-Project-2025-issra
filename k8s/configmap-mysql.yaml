# k8s/configmap-mysql-simple.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: tp-projet-config
  namespace: tp-projet-2025
data:
  application.yml: |
    # Configuration MINIMALE et FONCTIONNELLE
    spring:
      datasource:
        url: jdbc:mysql://mysql-service.tp-projet-2025.svc.cluster.local:3306/tpfoyer?useSSL=false&allowPublicKeyRetrieval=true
        username: tpuser
        password: tppassword
        driver-class-name: com.mysql.cj.jdbc.Driver
      
      jpa:
        hibernate:
          ddl-auto: update
        show-sql: true
    
    server:
      port: 8080
      # CONTEXT-PATH IMPORTANT : soit "/" soit "/tpProjet"
      servlet:
        context-path: /
    
    # Configuration Actuator SANS SÉCURITÉ pour les tests
    management:
      endpoints:
        web:
          exposure:
            include: "*"
          base-path: /actuator
      endpoint:
        health:
          show-details: always
          access: permitted
      security:
        enabled: false  # Désactiver la sécurité Actuator
